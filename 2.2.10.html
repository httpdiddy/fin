<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/style.css">
    <title>2.2.10 Мониторинг поведения при изменении параметров для выявления логических уязвимостей</title>
</head>
<body>
    <h3>2.2.10 Мониторинг поведения при изменении параметров для выявления логических уязвимостей</h3>

<p>Как и при тестировании обычных приложений (не связанных с финансами), все входные параметры в процессе оплаты должны тестироваться отдельно для выявления логических уязвимостей. В приведенном ниже примере поток процесса оплаты может быть изменен путем манипуляции определенными параметрами:</p>

<p>В веб-приложении существовал параметр, который указывал серверу использовать механизм 3D-Secure. Этот параметр можно было изменить, чтобы обойти процесс проверки.</p>

<p>Иногда веб-приложения содержат параметр, показывающий текущий номер страницы или этап. Пользователь может обойти определенные этапы или страницы, изменив этот параметр в следующем запросе.</p>

<p>Обычно не рекомендуется изменять более одного параметра в течение ограниченного времени тестирования. Однако некоторые логические уязвимости можно обнаружить только при одновременном изменении нескольких параметров. Это полезно, когда приложение обнаруживает манипуляции с такими параметрами, как поле цены. Хотя тестирование всех возможных комбинаций параметров может быть нецелесообразным, рекомендуется изменять одновременно хотя бы несколько интересных параметров. Для автоматизации этого теста целевое поле (например, цена или количество) можно установить на значение, которое обычно не допускается, а затем изменять другие параметры по одному, чтобы обнаружить возможные обходы механизмов валидации.</p>

<p>Пример серверного кода с уязвимостью:</p>

<pre>
1:  Try
2:      ' Delivery type should be an integer
3:      deliveryType = Int(deliveryType)
4:      ' Quantity should be an integer
5:      quantity = Int(quantity)
6:  Catch ex As Exception
7:      ' Empty catch!
8:  End Try
9:  ' Continue ...
</pre>

<p>Этот код проверяет, что переменная "deliveryType" содержит целое число, затем делает то же самое для переменной "quantity". Однако из-за пустого блока Catch в строке 7 параметр "quantity" может содержать десятичное число (например, "0.1"), если параметр "deliveryType" содержит строку (например, "foobar"). В этом случае приложение переходит в блок Catch из-за ошибки преобразования строки в целое число в строке 3, до преобразования параметра "quantity".</p>
</body>
</html>