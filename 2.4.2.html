<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2.4.2 Общие проблемы округления</title>
</head>
<body>
    <h3>2.4.2 Общие проблемы округления</h3>

<p>Проблемы округления не всегда ограничиваются обменом валют. Даже приложения для покупок, поддерживающие только один тип валюты, могут страдать от несоответствий между разными частями приложения.</p>

<p>Пример такого несоответствия, который следует проверять:</p>

<p>Пользователь выбирает внести £10.0049 на сайт, который может хранить баланс пользователя; сайт сохраняет эту сумму в базе данных для авторизации и добавляет её к балансу пользователя после завершения банковского перевода. Однако банковский API принимает только числа с двумя знаками после запятой согласно своему стандарту. Поэтому приложение конвертирует сумму в £10.00 и ожидает завершения транзакции. После завершения транзакции £10.00 будет списано с банковского счета пользователя, но £10.0049 будет зачислено на баланс сайта. Повторив этот процесс 205 раз, пользователь может получить £1.00.</p>

<p>Та же проблема возникает, когда денежные расчеты в одном приложении выполняются разными подсистемами или разным кодом. Примером может служить использование хранимых процедур базы данных для некоторых расчетов (например, перевод денег) и кода на C# с другими правилами для иных денежных операций (таких как снятие средств или отмена перевода).</p>
</body>
</html>