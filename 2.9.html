<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/style.css">
    <title>2.9 Проблемы криптографии</title>
</head>
<body>
    <h3>2.9 Проблемы криптографии</h3>
<p>CWE: 310</p>

<p>Криптографические методы, такие как шифрование, кодирование, подпись и хеширование, часто встречаются в платежных системах. Однако ошибки проектирования и реализации из-за человеческого фактора или недостатка знаний о векторах атак довольно распространены в этой области, особенно в приложениях, реализующих собственные криптографические методы вместо использования известных предварительно реализованных библиотек.</p>

<p>Например, когда приложение хеширует некоторые известные параметры с коротким и ненадежным секретным ключом, этот ключ можно легко подобрать, если известен алгоритм. Иногда приложения не используют длинные и надежные секретные ключи, если реализация этого не требует.</p>

<p>Другой пример - атака на расширение длины, при которой хеш секретного ключа, объединенного с другими значениями, может быть использован для добавления данных к исходному запросу путем дополнения исходных данных и вычисления нового хеша.</p>

<p>Объединенные значения в хеше подписи также должны использовать надежные разделители. В противном случае может быть возможным перемещение части значения параметра в значение другого параметра без изменения подписи, так как объединенная строка остается той же.</p>

<p>Следующий пример показывает хеш подписи на основе объединенных параметров без разделителей, что может сделать приложение уязвимым:</p>

<pre>
HMAC_SHA256(SecretKey, Other Parameters + ReferenceString + NumericalAmount)
</pre>

<p>Когда параметр "ReferenceString" может содержать произвольную строку, параметр "NumericalAmount" может быть изменен, как показано ниже, для создания того же хеша подписи:</p>

<pre>
OtherParams=OtherValues&...&ReferenceString=SomeStringHere&NumericalAmount=89
OtherParams=OtherValues&...&ReferenceString=SomeStringHere8&NumericalAmount=9
</pre>

<p>Когда зашифрованные значения используются в нескольких местах входных параметров (в куках или POST/GET запросах), приложение часто расшифровывает их также в нескольких местах. Пользователь может использовать эти страницы для расшифровки неизвестных зашифрованных значений, чтобы понять, как работает приложение. Проблема может быть серьезной, если пользователь может формировать и шифровать произвольные данные, используя предоставленные входные параметры, чтобы заменить текущие зашифрованные параметры.</p>

<p>Как обсуждалось в разделе "Атаки повторного воспроизведения", иногда нет необходимости взламывать криптографические методы, так как их можно воспроизвести.</p>
</body>
</html>